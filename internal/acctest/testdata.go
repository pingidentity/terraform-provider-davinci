package acctest

import (
	"encoding/json"
	"fmt"
	"io/ioutil"
	"path/filepath"
	"runtime"

	"github.com/mitchellh/mapstructure"
)

func FlowsForTests(resourceName string) TestFlowsHcl {
	flowJsons := getFlowJsons(resourceName)
	return TestFlowsHcl{
		Simple: makeFlowHcl(resourceName, flowResource{
			Name:        "simple",
			FlowJson:    flowJsons.Simple,
			Connections: []string{"http"},
		}),
		SimpleSettingDrift: makeFlowHcl(resourceName, flowResource{
			Name:        "simple",
			FlowJson:    flowJsons.SimpleSettingDrift,
			Connections: []string{"http"},
		}),
		SimpleInputSchemaDrift: makeFlowHcl(resourceName, flowResource{
			Name:        "simple",
			FlowJson:    flowJsons.SimpleInputSchemaDrift,
			Connections: []string{"http"},
		}),
		SimpleOutputSchemaDrift: makeFlowHcl(resourceName, flowResource{
			Name:        "simple",
			FlowJson:    flowJsons.SimpleOutputSchemaDrift,
			Connections: []string{"http"},
		}),
		Drifted: makeFlowHcl(resourceName, flowResource{
			Name:        "simple",
			FlowJson:    flowJsons.Drifted,
			Connections: []string{"http"},
		}),
		Mainflow: makeFlowHcl(resourceName, flowResource{
			Name:        "mainflow",
			FlowJson:    flowJsons.Mainflow,
			Subflows:    []string{"subflow", "another_subflow"},
			Connections: []string{"http", "flow"},
		}),
		MainflowDrifted: makeFlowHcl(resourceName, flowResource{
			Name:        "mainflow",
			FlowJson:    flowJsons.MainflowDrifted,
			Subflows:    []string{"subflow", "another_subflow"},
			Connections: []string{"http", "flow"},
		}),
		AnotherMainflow: makeFlowHcl(resourceName, flowResource{
			Name:        "another_mainflow",
			FlowJson:    flowJsons.AnotherMainflow,
			Subflows:    []string{"subflow"},
			Connections: []string{"http", "flow"},
		}),
		Subflow: makeFlowHcl(resourceName, flowResource{
			Name:        "subflow",
			FlowJson:    flowJsons.Subflow,
			Subflows:    []string{"another_subflow"},
			Connections: []string{"http", "flow"},
		}),
		AnotherSubflow: makeFlowHcl(resourceName, flowResource{
			Name:        "another_subflow",
			FlowJson:    flowJsons.AnotherSubflow,
			Connections: []string{"http"},
		}),
		WithVariableConnector: makeFlowHcl(resourceName, flowResource{
			Name:        "with_variable_connector",
			FlowJson:    flowJsons.WithVariableConnector,
			Connections: []string{"http", "variables"},
		}),
		BrokenFlow: makeFlowHcl(resourceName, flowResource{
			Name:        "broken_flow",
			FlowJson:    flowJsons.BrokenFlow,
			Connections: []string{"errorcustomize"},
		}),
		PingOneSessionMainFlow: makeFlowHcl(resourceName, flowResource{
			Name:        "pingone_session_main_flow",
			FlowJson:    flowJsons.PingOneSessionMainFlow,
			Connections: []string{"annotation", "flow", "pingoneauthentication", "node"},
		}),
		PingOneSessionMainFlowUpdate: makeFlowHcl(resourceName, flowResource{
			Name:        "pingone_session_main_flow",
			FlowJson:    flowJsons.PingOneSessionMainFlowUpdate,
			Connections: []string{"annotation", "flow", "pingoneauthentication", "node"},
		}),
		PingOneSessionSubFlow: makeFlowHcl(resourceName, flowResource{
			Name:        "pingone_session_sub_flow",
			FlowJson:    flowJsons.PingOneSessionSubFlow,
			Connections: []string{"annotation", "errorcustomize", "functions", "http", "node", "pingonesso", "variables"},
		}),
		FlowContextVarFlow: makeFlowHcl(resourceName, flowResource{
			Name:        "flow_context_var_flow",
			FlowJson:    flowJsons.FlowContextVarFlow,
			Connections: []string{"http", "variables"},
		}),
	}
}

// Hardcoded map of bootstrapped connections that come with new DV tenant.
// keys are connectorIds are one word lowercased
var bsConnections = map[string]flowConnection{
	"annotation": {
		ConnectorId: "annotationConnector",
		Name:        "Annotation",
		Id:          "921bfae85c38ed45045e07be703d86b8",
	},
	"errorcustomize": {
		ConnectorId: "errorConnector",
		Name:        "Error Customize",
		Id:          "6d8f6f706c45fd459a86b3f092602544",
	},
	"functions": {
		ConnectorId: "functionsConnector",
		Name:        "Function",
		Id:          "de650ca45593b82c49064ead10b9fe17",
	},
	"http": {
		ConnectorId: "httpConnector",
		Name:        "Http",
		Id:          "867ed4363b2bc21c860085ad2baa817d",
	},
	"pingonesso": {
		ConnectorId: "pingOneSSOConnector",
		Name:        "PingOne",
		Id:          "94141bf2f1b9b59a5f5365ff135e02bb",
	},
	"skopenid": {
		ConnectorId: "skOpenIdConnector",
		Name:        "Token Management",
		Id:          "3b55f2ca6689560c64cb5bed5afbe40f",
	},
	"userpolicy": {
		ConnectorId: "userPolicyConnector",
		Name:        "User Policy",
		Id:          "4cb5e3465d718a84087ec9b6a6251e52",
	},
	"skuserpool": {
		Name:        "Default User Pool",
		ConnectorId: "skUserPool",
		Id:          "defaultUserPool",
	},
	"variables": {
		ConnectorId: "variablesConnector",
		Name:        "Variables",
		Id:          "06922a684039827499bdbdd97f49827b",
	},
}

func getFlowJsons(resourceName string) TestFlowsJson {

	return TestFlowsJson{
		Simple:                       readFlowJsonFile("flows/simple.json", resourceName),
		SimpleSettingDrift:           readFlowJsonFile("flows/simplesettingdrift.json", resourceName),
		SimpleInputSchemaDrift:       readFlowJsonFile("flows/simpleinputschemadrift.json", resourceName),
		SimpleOutputSchemaDrift:      readFlowJsonFile("flows/simpleoutputschemadrift.json", resourceName),
		Drifted:                      readFlowJsonFile("flows/drifted.json", resourceName),
		Mainflow:                     fmt.Sprintf(`"{\"companyId\":\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\",\"authTokenExpireIds\":[],\"connectorIds\":[\"httpConnector\",\"flowConnector\"],\"createdDate\":1670454732029,\"currentVersion\":6,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"deployedDate\":1670454733430,\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"Mainflow-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"inside_0\\\",\\\"inside_1\\\",\\\"inside_2\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"9efyoqvfa0\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Hello from the Mainflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"inside_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"9efyoqvfa0\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"2wpmz4198g\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"Subflow-%[1]s\\\",\\\"value\\\":\\\"429812d959aecccd1523576fad6f91e4\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"pejfijdbpt\\\",\\\"transitionId\\\":1},{\\\"from\\\":[\\\"inside_0\\\"],\\\"to\\\":\\\"inside_1\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"2wpmz4198g\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"m432r60kfr\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Back in Mainflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":2,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"in4vwpucxv\\\",\\\"transitionId\\\":2},{\\\"from\\\":[\\\"inside_1\\\"],\\\"to\\\":\\\"inside_2\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"m432r60kfr\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"ere1uz4t28\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"AnotherSubflow-%[1]s\\\",\\\"value\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":3,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"13mio8w7g2\\\",\\\"transitionId\\\":3},{\\\"from\\\":[\\\"inside_2\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"ere1uz4t28\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"z96dut4g6g\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Final in Mainflow\\\"}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":4,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"o1aqwg7sfw\\\",\\\"transitionId\\\":4}],\\\"history\\\":[],\\\"outputs\\\":{\\\"flowConnector_startUiSubFlow\\\":{\\\"localOutputs\\\":[\\\"output\\\"]}},\\\"outputParameters\\\":[],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"9efyoqvfa0\\\":\\\"initialize\\\",\\\"9efyoqvfa0_customHtmlMessage\\\":\\\"initialize\\\",\\\"2wpmz4198g\\\":\\\"9efyoqvfa0\\\",\\\"2wpmz4198g_startUiSubFlow\\\":\\\"9efyoqvfa0_customHtmlMessage\\\",\\\"m432r60kfr\\\":\\\"2wpmz4198g\\\",\\\"m432r60kfr_customHtmlMessage\\\":\\\"2wpmz4198g_startUiSubFlow\\\",\\\"ere1uz4t28\\\":\\\"m432r60kfr\\\",\\\"ere1uz4t28_startUiSubFlow\\\":\\\"m432r60kfr_customHtmlMessage\\\",\\\"z96dut4g6g\\\":\\\"ere1uz4t28\\\",\\\"z96dut4g6g_customHtmlMessage\\\":\\\"ere1uz4t28_startUiSubFlow\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"9efyoqvfa0\\\":\\\"initialize\\\",\\\"2wpmz4198g\\\":[\\\"9efyoqvfa0\\\"],\\\"m432r60kfr\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\"],\\\"ere1uz4t28\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\",\\\"m432r60kfr\\\"],\\\"z96dut4g6g\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\",\\\"m432r60kfr\\\",\\\"ere1uz4t28\\\"]},\\\"nodeStates\\\":{\\\"9efyoqvfa0\\\":\\\"start_0\\\",\\\"2wpmz4198g\\\":\\\"inside_0\\\",\\\"m432r60kfr\\\":\\\"inside_1\\\",\\\"ere1uz4t28\\\":\\\"inside_2\\\",\\\"z96dut4g6g\\\":\\\"end_0\\\"}}\",\"publishedVersion\":6,\"updatedDate\":1670454733430,\"flowId\":\"c2ba2e98fb728d2106af0d5b6c046189\",\"versionId\":6,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"9efyoqvfa0\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Hello from the Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":277,\"y\":236},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"pejfijdbpt\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":413.0011014863953,\"y\":237.26968182392835},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"2wpmz4198g\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"Subflow-%[1]s\",\"value\":\"429812d959aecccd1523576fad6f91e4\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":549.0022029727908,\"y\":238.5393636478567},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"in4vwpucxv\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":700.5025338875053,\"y\":239.03887325126982},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"m432r60kfr\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Back in Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":852.0028648022196,\"y\":239.53838285468296},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"13mio8w7g2\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":984.0942547138801,\"y\":240.76566227303715},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"ere1uz4t28\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"AnotherSubflow-%[1]s\",\"value\":\"64f06befdbe8170f4da623115b18e58c\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":1116.1856446255406,\"y\":241.99294169139134},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"o1aqwg7sfw\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":1260.458901150811,\"y\":243.53840692322711},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"z96dut4g6g\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Final in Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"}}},\"position\":{\"x\":1404.7321576760817,\"y\":245.0838721550629},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"62trunpg0k\",\"source\":\"9efyoqvfa0\",\"target\":\"pejfijdbpt\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"5tzfv84xtb\",\"source\":\"pejfijdbpt\",\"target\":\"2wpmz4198g\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"eenp1c51e3\",\"source\":\"2wpmz4198g\",\"target\":\"in4vwpucxv\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"voz6lns37j\",\"source\":\"in4vwpucxv\",\"target\":\"m432r60kfr\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"v1dgu5q23h\",\"source\":\"m432r60kfr\",\"target\":\"13mio8w7g2\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"u76c604rmo\",\"source\":\"13mio8w7g2\",\"target\":\"ere1uz4t28\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"jh3psjmp9p\",\"source\":\"ere1uz4t28\",\"target\":\"o1aqwg7sfw\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"sx31kgbtse\",\"source\":\"o1aqwg7sfw\",\"target\":\"z96dut4g6g\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#AFD5FF\",\"savedDate\":1670454732003,\"variables\":[]}"`, resourceName),
		MainflowDrifted:              fmt.Sprintf(`"{\"companyId\":\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\",\"authTokenExpireIds\":[],\"connectorIds\":[\"httpConnector\",\"flowConnector\"],\"createdDate\":1670454732029,\"currentVersion\":6,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"deployedDate\":1670454733430,\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"Mainflow-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"inside_0\\\",\\\"inside_1\\\",\\\"inside_2\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"9efyoqvfa0\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Hello from the Drifted Mainflow!\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"inside_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"9efyoqvfa0\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"2wpmz4198g\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"Subflow-%[1]s\\\",\\\"value\\\":\\\"429812d959aecccd1523576fad6f91e4\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"pejfijdbpt\\\",\\\"transitionId\\\":1},{\\\"from\\\":[\\\"inside_0\\\"],\\\"to\\\":\\\"inside_1\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"2wpmz4198g\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"m432r60kfr\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Back in Mainflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":2,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"in4vwpucxv\\\",\\\"transitionId\\\":2},{\\\"from\\\":[\\\"inside_1\\\"],\\\"to\\\":\\\"inside_2\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"m432r60kfr\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"ere1uz4t28\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"AnotherSubflow-%[1]s\\\",\\\"value\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":3,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"13mio8w7g2\\\",\\\"transitionId\\\":3},{\\\"from\\\":[\\\"inside_2\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"ere1uz4t28\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"c2ba2e98fb728d2106af0d5b6c046189\\\",\\\"flowVersionId\\\":6,\\\"id\\\":\\\"z96dut4g6g\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Final in Mainflow\\\"}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":4,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"o1aqwg7sfw\\\",\\\"transitionId\\\":4}],\\\"history\\\":[],\\\"outputs\\\":{\\\"flowConnector_startUiSubFlow\\\":{\\\"localOutputs\\\":[\\\"output\\\"]}},\\\"outputParameters\\\":[],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"9efyoqvfa0\\\":\\\"initialize\\\",\\\"9efyoqvfa0_customHtmlMessage\\\":\\\"initialize\\\",\\\"2wpmz4198g\\\":\\\"9efyoqvfa0\\\",\\\"2wpmz4198g_startUiSubFlow\\\":\\\"9efyoqvfa0_customHtmlMessage\\\",\\\"m432r60kfr\\\":\\\"2wpmz4198g\\\",\\\"m432r60kfr_customHtmlMessage\\\":\\\"2wpmz4198g_startUiSubFlow\\\",\\\"ere1uz4t28\\\":\\\"m432r60kfr\\\",\\\"ere1uz4t28_startUiSubFlow\\\":\\\"m432r60kfr_customHtmlMessage\\\",\\\"z96dut4g6g\\\":\\\"ere1uz4t28\\\",\\\"z96dut4g6g_customHtmlMessage\\\":\\\"ere1uz4t28_startUiSubFlow\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"9efyoqvfa0\\\":\\\"initialize\\\",\\\"2wpmz4198g\\\":[\\\"9efyoqvfa0\\\"],\\\"m432r60kfr\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\"],\\\"ere1uz4t28\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\",\\\"m432r60kfr\\\"],\\\"z96dut4g6g\\\":[\\\"9efyoqvfa0\\\",\\\"2wpmz4198g\\\",\\\"m432r60kfr\\\",\\\"ere1uz4t28\\\"]},\\\"nodeStates\\\":{\\\"9efyoqvfa0\\\":\\\"start_0\\\",\\\"2wpmz4198g\\\":\\\"inside_0\\\",\\\"m432r60kfr\\\":\\\"inside_1\\\",\\\"ere1uz4t28\\\":\\\"inside_2\\\",\\\"z96dut4g6g\\\":\\\"end_0\\\"}}\",\"publishedVersion\":6,\"updatedDate\":1670454733430,\"flowId\":\"c2ba2e98fb728d2106af0d5b6c046189\",\"versionId\":6,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"9efyoqvfa0\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Hello from the Drifted Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":277,\"y\":236},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"pejfijdbpt\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":413.0011014863953,\"y\":237.26968182392835},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"2wpmz4198g\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"Subflow-%[1]s\",\"value\":\"429812d959aecccd1523576fad6f91e4\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":549.0022029727908,\"y\":238.5393636478567},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"in4vwpucxv\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":700.5025338875053,\"y\":239.03887325126982},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"m432r60kfr\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Back in Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":852.0028648022196,\"y\":239.53838285468296},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"13mio8w7g2\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":984.0942547138801,\"y\":240.76566227303715},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"ere1uz4t28\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"AnotherSubflow-%[1]s\",\"value\":\"64f06befdbe8170f4da623115b18e58c\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":1116.1856446255406,\"y\":241.99294169139134},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"o1aqwg7sfw\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":1260.458901150811,\"y\":243.53840692322711},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"z96dut4g6g\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Final in Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"}}},\"position\":{\"x\":1404.7321576760817,\"y\":245.0838721550629},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"62trunpg0k\",\"source\":\"9efyoqvfa0\",\"target\":\"pejfijdbpt\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"5tzfv84xtb\",\"source\":\"pejfijdbpt\",\"target\":\"2wpmz4198g\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"eenp1c51e3\",\"source\":\"2wpmz4198g\",\"target\":\"in4vwpucxv\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"voz6lns37j\",\"source\":\"in4vwpucxv\",\"target\":\"m432r60kfr\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"v1dgu5q23h\",\"source\":\"m432r60kfr\",\"target\":\"13mio8w7g2\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"u76c604rmo\",\"source\":\"13mio8w7g2\",\"target\":\"ere1uz4t28\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"jh3psjmp9p\",\"source\":\"ere1uz4t28\",\"target\":\"o1aqwg7sfw\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"sx31kgbtse\",\"source\":\"o1aqwg7sfw\",\"target\":\"z96dut4g6g\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#AFD5FF\",\"savedDate\":1670454732003,\"variables\":[]}"`, resourceName),
		Subflow:                      fmt.Sprintf(`"{\"companyId\":\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\",\"authTokenExpireIds\":[],\"connectorIds\":[\"httpConnector\",\"flowConnector\"],\"createdDate\":1670454705781,\"currentVersion\":3,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"deployedDate\":1670454706884,\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"Subflow-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"429812d959aecccd1523576fad6f91e4\\\",\\\"flowVersionId\\\":3,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"inside_0\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"429812d959aecccd1523576fad6f91e4\\\",\\\"flowVersionId\\\":3,\\\"id\\\":\\\"715120bll4\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Hello from Subflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"inside_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"715120bll4\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"429812d959aecccd1523576fad6f91e4\\\",\\\"flowVersionId\\\":3,\\\"id\\\":\\\"vgamnozt1u\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"AnotherSubflow-%[1]s\\\",\\\"value\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"j696kn2yrt\\\",\\\"transitionId\\\":1},{\\\"from\\\":[\\\"inside_0\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"vgamnozt1u\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"429812d959aecccd1523576fad6f91e4\\\",\\\"flowVersionId\\\":3,\\\"id\\\":\\\"nzmx3z0bpz\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"createSuccessResponse\\\",\\\"properties\\\":{},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"*\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":2,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"3833j38d1k\\\",\\\"transitionId\\\":2}],\\\"history\\\":[],\\\"outputs\\\":{\\\"flowConnector_startUiSubFlow\\\":{\\\"localOutputs\\\":[\\\"output\\\"]}},\\\"outputParameters\\\":[],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"715120bll4\\\":\\\"initialize\\\",\\\"715120bll4_customHtmlMessage\\\":\\\"initialize\\\",\\\"vgamnozt1u\\\":\\\"715120bll4\\\",\\\"vgamnozt1u_startUiSubFlow\\\":\\\"715120bll4_customHtmlMessage\\\",\\\"nzmx3z0bpz\\\":\\\"vgamnozt1u\\\",\\\"nzmx3z0bpz_createSuccessResponse\\\":\\\"vgamnozt1u_startUiSubFlow\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"715120bll4\\\":\\\"initialize\\\",\\\"vgamnozt1u\\\":[\\\"715120bll4\\\"],\\\"nzmx3z0bpz\\\":[\\\"715120bll4\\\",\\\"vgamnozt1u\\\"]},\\\"nodeStates\\\":{\\\"715120bll4\\\":\\\"start_0\\\",\\\"vgamnozt1u\\\":\\\"inside_0\\\",\\\"nzmx3z0bpz\\\":\\\"end_0\\\"}}\",\"publishedVersion\":3,\"updatedDate\":1670454706885,\"flowId\":\"429812d959aecccd1523576fad6f91e4\",\"versionId\":3,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"715120bll4\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Hello from Subflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":277,\"y\":237.46066042068742},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"j696kn2yrt\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":435.501184215074,\"y\":236.7303302103437},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"nzmx3z0bpz\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"createSuccessResponse\",\"type\":\"action\",\"properties\":{}},\"position\":{\"x\":930,\"y\":240},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"vgamnozt1u\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"AnotherSubflow-%[1]s\",\"value\":\"64f06befdbe8170f4da623115b18e58c\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":600,\"y\":240},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"3833j38d1k\",\"nodeType\":\"EVAL\"},\"position\":{\"x\":765,\"y\":240},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"lb1a50kolu\",\"source\":\"715120bll4\",\"target\":\"j696kn2yrt\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"opxp0j9hx1\",\"source\":\"j696kn2yrt\",\"target\":\"vgamnozt1u\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"ver96ovudf\",\"source\":\"vgamnozt1u\",\"target\":\"3833j38d1k\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"n3wxiozbjq\",\"source\":\"3833j38d1k\",\"target\":\"nzmx3z0bpz\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#AFD5FF\",\"savedDate\":1670454705745,\"variables\":[]}"`, resourceName),
		AnotherMainflow:              fmt.Sprintf(`"{\"companyId\":\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\",\"authTokenExpireIds\":[],\"connectorIds\":[\"httpConnector\",\"flowConnector\"],\"createdDate\":1670454819423,\"currentVersion\":2,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"deployedDate\":1670454822120,\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"AnotherMainflow-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"94e1b4a6a39ad267434d750a964f2f44\\\",\\\"flowVersionId\\\":2,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"inside_0\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"94e1b4a6a39ad267434d750a964f2f44\\\",\\\"flowVersionId\\\":2,\\\"id\\\":\\\"4xlw7ugv6z\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Hello from AnotherMainflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"inside_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"4xlw7ugv6z\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Flow\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"94e1b4a6a39ad267434d750a964f2f44\\\",\\\"flowVersionId\\\":2,\\\"id\\\":\\\"lwm7tdp8wg\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"properties\\\":{\\\"subFlowId\\\":{\\\"value\\\":{\\\"label\\\":\\\"Subflow-%[1]s\\\",\\\"value\\\":\\\"429812d959aecccd1523576fad6f91e4\\\"}},\\\"subFlowVersionId\\\":{\\\"value\\\":-1}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.cookies\\\",\\\"global.ip\\\",\\\"global.userAgent\\\",\\\"global.skOpenId\\\",\\\"global.origin\\\",\\\"global.originCookies\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"ygtoiozc7d\\\",\\\"transitionId\\\":1},{\\\"from\\\":[\\\"inside_0\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"lwm7tdp8wg\\\",\\\"connectionId\\\":\\\"6cfe3583c35bbf54a68eea351b55862d\\\",\\\"connectorId\\\":\\\"flowConnector\\\",\\\"capabilityName\\\":\\\"startUiSubFlow\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"94e1b4a6a39ad267434d750a964f2f44\\\",\\\"flowVersionId\\\":2,\\\"id\\\":\\\"nfixv1aq7h\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Back in Mainflow\\\"}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":2,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"s8rurw6ogo\\\",\\\"transitionId\\\":2}],\\\"history\\\":[],\\\"outputs\\\":{\\\"flowConnector_startUiSubFlow\\\":{\\\"localOutputs\\\":[\\\"output\\\"]}},\\\"outputParameters\\\":[],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"4xlw7ugv6z\\\":\\\"initialize\\\",\\\"4xlw7ugv6z_customHtmlMessage\\\":\\\"initialize\\\",\\\"lwm7tdp8wg\\\":\\\"4xlw7ugv6z\\\",\\\"lwm7tdp8wg_startUiSubFlow\\\":\\\"4xlw7ugv6z_customHtmlMessage\\\",\\\"nfixv1aq7h\\\":\\\"lwm7tdp8wg\\\",\\\"nfixv1aq7h_customHtmlMessage\\\":\\\"lwm7tdp8wg_startUiSubFlow\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"4xlw7ugv6z\\\":\\\"initialize\\\",\\\"lwm7tdp8wg\\\":[\\\"4xlw7ugv6z\\\"],\\\"nfixv1aq7h\\\":[\\\"4xlw7ugv6z\\\",\\\"lwm7tdp8wg\\\"]},\\\"nodeStates\\\":{\\\"4xlw7ugv6z\\\":\\\"start_0\\\",\\\"lwm7tdp8wg\\\":\\\"inside_0\\\",\\\"nfixv1aq7h\\\":\\\"end_0\\\"}}\",\"publishedVersion\":2,\"updatedDate\":1670454822120,\"flowId\":\"94e1b4a6a39ad267434d750a964f2f44\",\"versionId\":2,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"4xlw7ugv6z\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Hello from AnotherMainflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":400,\"y\":400},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"ygtoiozc7d\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":564.0012044376399,\"y\":396.26965173824817},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"lwm7tdp8wg\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6cfe3583c35bbf54a68eea351b55862d\",\"connectorId\":\"flowConnector\",\"name\":\"Flow\",\"label\":\"Flow\",\"status\":\"configured\",\"capabilityName\":\"startUiSubFlow\",\"type\":\"trigger\",\"properties\":{\"subFlowId\":{\"value\":{\"label\":\"Subflow-%[1]s\",\"value\":\"429812d959aecccd1523576fad6f91e4\"}},\"subFlowVersionId\":{\"value\":\"-1\"}}},\"position\":{\"x\":728.0024088752797,\"y\":392.5393034764964},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"s8rurw6ogo\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":882.5029769455396,\"y\":389.0392824165202},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"nfixv1aq7h\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Back in Mainflow\\\"\\n      }\\n    ]\\n  }\\n]\"}}},\"position\":{\"x\":1037.0035450157993,\"y\":385.5392613565441},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"jpamko0uag\",\"source\":\"4xlw7ugv6z\",\"target\":\"ygtoiozc7d\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"i9iji3pgoc\",\"source\":\"ygtoiozc7d\",\"target\":\"lwm7tdp8wg\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"9fg3exlq6u\",\"source\":\"lwm7tdp8wg\",\"target\":\"s8rurw6ogo\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"kb903zcmb3\",\"source\":\"s8rurw6ogo\",\"target\":\"nfixv1aq7h\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#AFD5FF\",\"savedDate\":1670454819392,\"variables\":[]}"`, resourceName),
		AnotherSubflow:               fmt.Sprintf(`"{\"companyId\":\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\",\"authTokenExpireIds\":[],\"connectorIds\":[\"httpConnector\"],\"createdDate\":1670454549078,\"currentVersion\":1,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"deployedDate\":1670454550290,\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"AnotherSubflow-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\",\\\"flowVersionId\\\":1,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\",\\\"flowVersionId\\\":1,\\\"id\\\":\\\"2eor2o01yd\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"Hello from AnotherSubflow\\\"},\\\"showContinueButton\\\":{\\\"value\\\":true}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"2eor2o01yd\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"c7d4b54e-7d9d-4bec-a215-53bad73489f0\\\",\\\"flowId\\\":\\\"64f06befdbe8170f4da623115b18e58c\\\",\\\"flowVersionId\\\":1,\\\"id\\\":\\\"v6dd1n2nef\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"createSuccessResponse\\\",\\\"properties\\\":{},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"*\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"si75sg75j4\\\",\\\"transitionId\\\":1}],\\\"history\\\":[],\\\"outputs\\\":{},\\\"outputParameters\\\":[],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"2eor2o01yd\\\":\\\"initialize\\\",\\\"2eor2o01yd_customHtmlMessage\\\":\\\"initialize\\\",\\\"v6dd1n2nef\\\":\\\"2eor2o01yd\\\",\\\"v6dd1n2nef_createSuccessResponse\\\":\\\"2eor2o01yd_customHtmlMessage\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"2eor2o01yd\\\":\\\"initialize\\\",\\\"v6dd1n2nef\\\":[\\\"2eor2o01yd\\\"]},\\\"nodeStates\\\":{\\\"2eor2o01yd\\\":\\\"start_0\\\",\\\"v6dd1n2nef\\\":\\\"end_0\\\"}}\",\"publishedVersion\":1,\"updatedDate\":1670454550290,\"flowId\":\"64f06befdbe8170f4da623115b18e58c\",\"versionId\":1,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"2eor2o01yd\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"Hello from AnotherSubflow\\\"\\n      }\\n    ]\\n  }\\n]\"},\"showContinueButton\":{\"value\":true}}},\"position\":{\"x\":400,\"y\":400},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"si75sg75j4\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":605.0013551876764,\"y\":402.7696908496324},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"v6dd1n2nef\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"createSuccessResponse\",\"type\":\"action\",\"properties\":{}},\"position\":{\"x\":810.0027103753529,\"y\":405.5393816992648},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"49g53utkgw\",\"source\":\"2eor2o01yd\",\"target\":\"si75sg75j4\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"a5e8fky7ns\",\"source\":\"si75sg75j4\",\"target\":\"v6dd1n2nef\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#AFD5FF\",\"savedDate\":1670454549054,\"variables\":[]}"`, resourceName),
		WithVariableConnector:        fmt.Sprintf(`"{\"companyId\":\"83fc9c23-6453-4134-95b2-661fcc1eba49\",\"authTokenExpireIds\":[],\"connectorIds\":[\"variablesConnector\",\"httpConnector\"],\"createdDate\":1675442964401,\"currentVersion\":1,\"customerId\":\"3193f25769a3f1e1591a1ebc82d51b13\",\"deployedDate\":1675442966019,\"description\":\"\",\"enabledGraphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"zclitlw73r\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"06922a684039827499bdbdd97f49827b\",\"connectorId\":\"variablesConnector\",\"name\":\"Variables\",\"label\":\"Variables\",\"status\":\"configured\",\"capabilityName\":\"saveValue\",\"type\":\"trigger\",\"properties\":{\"saveVariables\":{\"value\":[{\"name\":null,\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"type\\\": \\\"link\\\",\\n        \\\"src\\\": \\\"variable.svg\\\",\\n        \\\"url\\\": \\\"simpleCompany\\\",\\n        \\\"data\\\": \\\"{{global.company.variables.simpleCompany}}\\\",\\n        \\\"tooltip\\\": \\\"{{global.company.variables.simpleCompany}}\\\",\\n        \\\"children\\\": [\\n          {\\n            \\\"text\\\": \\\"simpleCompany\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      }\\n    ]\\n  }\\n]\",\"key\":0.7657645725170312,\"type\":\"string\",\"nameDefault\":\"simpleCompany\"}]}}},\"position\":{\"x\":0,\"y\":0},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"igeltxspjk\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"2fwvg7vbmf\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"variable is: \\\"\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"type\\\": \\\"link\\\",\\n        \\\"src\\\": \\\"variables.svg\\\",\\n        \\\"url\\\": \\\"output\\\",\\n        \\\"data\\\": \\\"{{local.zclitlw73r.payload.output}}\\\",\\n        \\\"tooltip\\\": \\\"{{local.zclitlw73r.payload.output}}\\\",\\n        \\\"children\\\": [\\n          {\\n            \\\"text\\\": \\\"output\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      }\\n    ]\\n  }\\n]\"}}},\"position\":{\"x\":0,\"y\":0},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"puuq38mrou\",\"source\":\"zclitlw73r\",\"target\":\"igeltxspjk\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"fx0d54uitd\",\"source\":\"igeltxspjk\",\"target\":\"2fwvg7vbmf\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowStatus\":\"enabled\",\"name\":\"printCompanyVar-%[1]s\",\"orx\":\"{\\\"companyId\\\":\\\"83fc9c23-6453-4134-95b2-661fcc1eba49\\\",\\\"flowId\\\":\\\"d5df2d3c437145314a0d195c5283ca3a\\\",\\\"flowVersionId\\\":1,\\\"version\\\":\\\"4.0.0\\\",\\\"states\\\":[\\\"initialize\\\",\\\"start_0\\\",\\\"end_0\\\"],\\\"currentState\\\":[\\\"initialize\\\"],\\\"transitions\\\":[{\\\"from\\\":[\\\"initialize\\\"],\\\"to\\\":\\\"start_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"initializeFlow\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Variables\\\",\\\"companyId\\\":\\\"83fc9c23-6453-4134-95b2-661fcc1eba49\\\",\\\"flowId\\\":\\\"d5df2d3c437145314a0d195c5283ca3a\\\",\\\"flowVersionId\\\":1,\\\"id\\\":\\\"zclitlw73r\\\",\\\"connectionId\\\":\\\"06922a684039827499bdbdd97f49827b\\\",\\\"connectorId\\\":\\\"variablesConnector\\\",\\\"capabilityName\\\":\\\"saveValue\\\",\\\"properties\\\":{\\\"saveVariables\\\":{\\\"value\\\":[{\\\"name\\\":null,\\\"value\\\":\\\"{{global.company.variables.simpleCompany}}\\\",\\\"key\\\":0.7657645725170312,\\\"type\\\":\\\"string\\\",\\\"nameDefault\\\":\\\"simpleCompany\\\"}]}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[],\\\"transitionId\\\":0,\\\"signalId\\\":0}],\\\"transitionId\\\":0},{\\\"from\\\":[\\\"start_0\\\"],\\\"to\\\":\\\"end_0\\\",\\\"conditions\\\":{\\\"$and\\\":[{\\\"id\\\":\\\"zclitlw73r\\\",\\\"connectionId\\\":\\\"06922a684039827499bdbdd97f49827b\\\",\\\"connectorId\\\":\\\"variablesConnector\\\",\\\"capabilityName\\\":\\\"saveValue\\\",\\\"success\\\":true}]},\\\"signals\\\":[{\\\"name\\\":\\\"Http\\\",\\\"companyId\\\":\\\"83fc9c23-6453-4134-95b2-661fcc1eba49\\\",\\\"flowId\\\":\\\"d5df2d3c437145314a0d195c5283ca3a\\\",\\\"flowVersionId\\\":1,\\\"id\\\":\\\"2fwvg7vbmf\\\",\\\"connectionId\\\":\\\"867ed4363b2bc21c860085ad2baa817d\\\",\\\"connectorId\\\":\\\"httpConnector\\\",\\\"capabilityName\\\":\\\"customHtmlMessage\\\",\\\"properties\\\":{\\\"message\\\":{\\\"value\\\":\\\"variable is: {{local.zclitlw73r.payload.output}}\\\"}},\\\"debugMode\\\":false,\\\"logLevel\\\":null,\\\"isDisabled\\\":false,\\\"inputs\\\":[\\\"global.error\\\"],\\\"respondToUser\\\":true,\\\"transitionId\\\":1,\\\"signalId\\\":0}],\\\"evalNodeId\\\":\\\"igeltxspjk\\\",\\\"transitionId\\\":1}],\\\"history\\\":[],\\\"outputs\\\":{\\\"variablesConnector_saveValue\\\":{\\\"localOutputs\\\":[\\\"output\\\"]}},\\\"outputParameters\\\":[\\\"global.company.variables.simpleCompany\\\",\\\"local.zclitlw73r.payload.output\\\"],\\\"global\\\":{},\\\"local\\\":{},\\\"idMapping\\\":{},\\\"nodeMappingForTids\\\":{\\\"2fwvg7vbmf\\\":\\\"initialize\\\",\\\"2fwvg7vbmf_customHtmlMessage\\\":\\\"initialize\\\"},\\\"tids\\\":{},\\\"delayedConditionalStateChangeMappings\\\":{},\\\"delayedConditionalStateChangeMappingsReverse\\\":{},\\\"delayedConditionalStatesList\\\":[],\\\"lbsTransitionIdsToIgnore\\\":[],\\\"lbsTransitionIdsMapping\\\":{},\\\"outputParametersDefault\\\":{\\\"global.company.variables.simpleCompany\\\":\\\"\\\",\\\"local.zclitlw73r.payload.output\\\":\\\"\\\"},\\\"outputParametersDefaultBlacklist\\\":[],\\\"historyThreshold\\\":70,\\\"errorRewindBlackListIds\\\":[],\\\"nodeMappingForTidsNew\\\":{\\\"2fwvg7vbmf\\\":\\\"initialize\\\"},\\\"nodeStates\\\":{\\\"zclitlw73r\\\":\\\"start_0\\\",\\\"2fwvg7vbmf\\\":\\\"end_0\\\"}}\",\"publishedVersion\":1,\"updatedDate\":1675442966019,\"flowId\":\"d5df2d3c437145314a0d195c5283ca3a\",\"versionId\":1,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"zclitlw73r\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"06922a684039827499bdbdd97f49827b\",\"connectorId\":\"variablesConnector\",\"name\":\"Variables\",\"label\":\"Variables\",\"status\":\"configured\",\"capabilityName\":\"saveValue\",\"type\":\"trigger\",\"properties\":{\"saveVariables\":{\"value\":[{\"name\":null,\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"type\\\": \\\"link\\\",\\n        \\\"src\\\": \\\"variable.svg\\\",\\n        \\\"url\\\": \\\"simpleCompany\\\",\\n        \\\"data\\\": \\\"{{global.company.variables.simpleCompany}}\\\",\\n        \\\"tooltip\\\": \\\"{{global.company.variables.simpleCompany}}\\\",\\n        \\\"children\\\": [\\n          {\\n            \\\"text\\\": \\\"simpleCompany\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      }\\n    ]\\n  }\\n]\",\"key\":0.7657645725170312,\"type\":\"string\",\"nameDefault\":\"simpleCompany\"}]}}},\"position\":{\"x\":180,\"y\":300},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"igeltxspjk\",\"nodeType\":\"EVAL\",\"label\":\"Evaluator\"},\"position\":{\"x\":321,\"y\":300.83333587646484},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"},{\"data\":{\"id\":\"2fwvg7vbmf\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"867ed4363b2bc21c860085ad2baa817d\",\"connectorId\":\"httpConnector\",\"name\":\"Http\",\"label\":\"Http\",\"status\":\"configured\",\"capabilityName\":\"customHtmlMessage\",\"type\":\"trigger\",\"properties\":{\"message\":{\"value\":\"[\\n  {\\n    \\\"children\\\": [\\n      {\\n        \\\"text\\\": \\\"variable is: \\\"\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      },\\n      {\\n        \\\"type\\\": \\\"link\\\",\\n        \\\"src\\\": \\\"variables.svg\\\",\\n        \\\"url\\\": \\\"output\\\",\\n        \\\"data\\\": \\\"{{local.zclitlw73r.payload.output}}\\\",\\n        \\\"tooltip\\\": \\\"{{local.zclitlw73r.payload.output}}\\\",\\n        \\\"children\\\": [\\n          {\\n            \\\"text\\\": \\\"output\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"text\\\": \\\"\\\"\\n      }\\n    ]\\n  }\\n]\"}}},\"position\":{\"x\":462,\"y\":301.6666717529297},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}],\"edges\":[{\"data\":{\"id\":\"puuq38mrou\",\"source\":\"zclitlw73r\",\"target\":\"igeltxspjk\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"},{\"data\":{\"id\":\"fx0d54uitd\",\"source\":\"igeltxspjk\",\"target\":\"2fwvg7vbmf\"},\"position\":{\"x\":0,\"y\":0},\"group\":\"edges\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":true,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#E3F0FF\",\"savedDate\":1675442964375,\"variables\":[]}"`, resourceName),
		BrokenFlow:                   fmt.Sprintf(`"{\"companyId\":\"0a77c43b-3afd-4f08-b88c-61e811f3d0d9\",\"connectorIds\":[\"errorConnector\"],\"createdDate\":1675789456863,\"currentVersion\":0,\"customerId\":\"ee728871d18a3b9b273c87192cee4a18\",\"description\":\"\",\"flowStatus\":\"enabled\",\"name\":\"brokenFlow%[1]s\",\"updatedDate\":1675789456873,\"flowId\":\"ef5eab24ebe4f578cd73ec4acb79b78d\",\"versionId\":0,\"graphData\":{\"elements\":{\"nodes\":[{\"data\":{\"id\":\"zlgncqvws2\",\"nodeType\":\"CONNECTION\",\"connectionId\":\"6d8f6f706c45fd459a86b3f092602544\",\"connectorId\":\"errorConnector\",\"name\":\"Error Customize\",\"label\":\"Error Customize\",\"status\":\"unconfigured\"},\"position\":{\"x\":400,\"y\":409.0909090042114},\"group\":\"nodes\",\"removed\":false,\"selected\":false,\"selectable\":true,\"locked\":false,\"grabbable\":true,\"pannable\":false,\"classes\":\"\"}]},\"data\":{},\"zoomingEnabled\":true,\"userZoomingEnabled\":true,\"zoom\":1,\"minZoom\":1e-50,\"maxZoom\":1e+50,\"panningEnabled\":true,\"userPanningEnabled\":true,\"pan\":{\"x\":0,\"y\":0},\"boxSelectionEnabled\":true,\"renderer\":{\"name\":\"null\"}},\"flowColor\":\"#FFC8C1\",\"savedDate\":1675789456846,\"variables\":[]}"`, resourceName),
		PingOneSessionMainFlow:       readFlowJsonFile("flows/p1sessionmainflow.json", resourceName),
		PingOneSessionMainFlowUpdate: readFlowJsonFile("flows/p1sessionmainflowupdate.json", resourceName),
		PingOneSessionSubFlow:        readFlowJsonFile("flows/p1sessionsubflow.json", resourceName),
		FlowContextVarFlow:           readFlowJsonFile("flows/flowcontextvarflow.json", resourceName),
	}
}

// takes path to json file, adjusts flow name attribute to include unique resource name, and returns json string
func readFlowJsonFile(path string, resourceName string) string {
	_, currentPath, _, ok := runtime.Caller(0)
	if !ok {
		panic("could not get current file")
	}
	flowByte, err := ioutil.ReadFile(filepath.Join(filepath.Dir(currentPath), path))
	if err != nil {
		panic(err)
	}

	var flowMap map[string]interface{}
	err = json.Unmarshal(flowByte, &flowMap)
	if err != nil {
		panic(err)
	}

	flowMap["name"] = flowMap["name"].(string) + "-" + resourceName

	flowByte, err = json.Marshal(flowMap)
	if err != nil {
		panic(err)
	}
	flowJson, err := json.Marshal(string(flowByte))
	if err != nil {
		panic(err)
	}

	return string(flowJson)
}

func FlowsForTestsMap(resourceName string) map[string]string {
	var flowsMap map[string]string
	testFlows := FlowsForTests(resourceName)
	mapstructure.Decode(testFlows, &flowsMap)
	return flowsMap
}

// Data read of bootstrapped connections to be used in davinci_flow connections blocks
func BsConnectionsHcl(resourceName string) string {
	var tc string
	for i, conn := range bsConnections {
		hcl := fmt.Sprintf(`
data "davinci_connection" "%[1]s-%[2]s" {
	environment_id = resource.pingone_role_assignment_user.%[1]s.scope_environment_id
	id = "%[3]s"
	depends_on = [data.davinci_connections.read_all]
}

`, resourceName, i, conn.Id)
		tc = tc + hcl
	}
	return tc
}

func KitchenSink(resourceName string) string {
	var hcl string
	baseHcl := PingoneEnvrionmentSsoHcl(resourceName)
	flows := addAllTestFlows(resourceName, baseHcl)

	return hcl + baseHcl + flows
}

func addAllTestFlows(resourceName string, hcl string) string {
	testFlows := FlowsForTestsMap(resourceName)
	var flowHcl string
	for i, flow := range testFlows {
		flowHcl += fmt.Sprintf(`
resource "davinci_flow" "%[2]s-%[1]s" {
	environment_id = resource.pingone_role_assignment_user.%[1]s.scope_environment_id
	depends_on = [data.davinci_connections.read_all]
	flow_json = %[3]s
	deploy = true
}

`, resourceName, i, flow)
	}
	hcl = hcl + flowHcl
	return hcl

}

func makeSubflowsHcl(resourceName string, subflows []string) (subflowsHcl string) {
	for _, subflowName := range subflows {
		subflowsHcl += fmt.Sprintf(`
	subflow_link {
		id = davinci_flow.%[1]s-%[2]s.id
		name = davinci_flow.%[1]s-%[2]s.name
	}
		
`, resourceName, subflowName)
	}
	return subflowsHcl
}

func makeFlowConnectionsHcl(resourceName string, connections []string) (connectionsHcl string) {
	for _, connName := range connections {
		rName := fmt.Sprintf("davinci_connection.%s-%s", resourceName, connName)
		if _, ok := bsConnections[connName]; ok {
			rName = "data." + rName
		}

		connectionsHcl += fmt.Sprintf(`
	connection_link {
		id = %[1]s.id
		name = %[1]s.name
	}
	
`,
			rName)
	}
	return connectionsHcl
}

func makeFlowHcl(resourceName string, flow flowResource) FlowHcl {
	subflowsHcl := makeSubflowsHcl(resourceName, flow.Subflows)
	connectionsHcl := makeFlowConnectionsHcl(resourceName, flow.Connections)
	hcl := fmt.Sprintf(`
resource "davinci_flow" "%[1]s-%[2]s" {
	flow_json = %[3]s
	environment_id = resource.pingone_role_assignment_user.%[1]s.scope_environment_id
	depends_on = [data.davinci_connections.read_all]

	deploy = true
	
	%[4]s

	%[5]s
}
`, resourceName, flow.Name, flow.FlowJson, subflowsHcl, connectionsHcl)
	flowHcl := FlowHcl{
		Name: resourceName + "-" + flow.Name,
		Hcl:  hcl,
	}
	return flowHcl
}
